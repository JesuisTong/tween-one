{"version":3,"sources":["webpack:///./src/plugin/SvgDrawPlugin.jsx?f897","webpack:///./examples/svgDrawShape.js"],"names":["SvgDrawPlugin","target","vars","start","tagName","toLowerCase","prototype","name","useStyle","setVars","_vars","end","data","split","length","indexOf","parseFloat","Error","getComputedStyle","document","defaultView","getLineLength","x1","y1","x2","y2","_x2","_y2","Math","sqrt","getPolyLength","pointsArray","getAttribute","map","item","n","push","forEach","i","nextPoint","getEllipseLength","rx","ry","PI","getAnimStart","computedStyle","getTotalLength","strokeDasharray","strokeDashoffset","setRatio","r","t","style","plugins","dataStartArr","Demo","arguments","state","tweenData","onClick","setState","render","bind","SVGDraw","duration","fill","strokeWidth","stroke","transform","Component","getElementById"],"mappings":"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","file":"svgDrawShape.js","sourcesContent":["/* eslint-disable func-names */\nconst SvgDrawPlugin = function (target, vars) {\n  this.target = target;\n  this.vars = vars;\n  this.start = {};\n  this.tagName = this.target.tagName.toLowerCase();\n};\nSvgDrawPlugin.prototype = {\n  name: 'SVGDraw',\n  useStyle: 'stroke-dasharray, stroke-dashoffset',\n  setVars(vars) {\n    const _vars = { start: 0 };\n    if (typeof vars === 'number') {\n      _vars.end = vars;\n      return _vars;\n    }\n    const data = vars.split(' ');\n    if (data.length > 1) {\n      _vars.start = data[0].indexOf('%') >= 0 ?\n      parseFloat(data[0]) / 100 * this.length : parseFloat(data[0]);\n      _vars.end = data[1].indexOf('%') >= 0 ?\n      parseFloat(data[1]) / 100 * this.length : parseFloat(data[1]);\n    } else if (parseFloat(vars)) {\n      _vars.end = vars.indexOf('%') >= 0 ?\n      parseFloat(vars) / 100 * this.length : parseFloat(vars);\n    } else {\n      throw new Error(`SVGDraw data[${vars}] error.`);\n    }\n    return _vars;\n  },\n  getComputedStyle() {\n    return document.defaultView ? document.defaultView.getComputedStyle(this.target) : {};\n  },\n  getLineLength(x1, y1, x2, y2) {\n    const _x2 = parseFloat(x2) - parseFloat(x1);\n    const _y2 = parseFloat(y2) - parseFloat(y1);\n    return Math.sqrt(_x2 * _x2 + _y2 * _y2);\n  },\n  getPolyLength(name) {\n    // .match(/(?:(-|-=|\\+=)?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)[0-9]/gi)\n    const pointsArray = (this.target.getAttribute('points') || '').split(/\\s+/)\n      .map(item => item.split(',').map(n => parseFloat(n)));\n    if (name === 'polygon') {\n      pointsArray.push(pointsArray[0]);\n    }\n    let length = 0;\n    pointsArray.forEach((item, i) => {\n      if (i < pointsArray.length - 1) {\n        const nextPoint = pointsArray[i + 1];\n        length += this.getLineLength(item[0], item[1], nextPoint[0], nextPoint[1]);\n      }\n    });\n    return length;\n  },\n  getEllipseLength() {\n    const rx = parseFloat(this.target.getAttribute('rx'));\n    const ry = parseFloat(this.target.getAttribute('ry'));\n    if (!rx || !ry) {\n      throw new Error(`ellipse rx or ry error.`);\n    }\n    return Math.PI * (3 * (rx + ry) - Math.sqrt((3 * rx + ry) * (3 * ry + rx)));\n  },\n  getAnimStart() {\n    const computedStyle = this.getComputedStyle();\n    switch (this.tagName) {\n      case 'rect':\n        this.length = this.target.getAttribute('width') * 2 +\n          this.target.getAttribute('height') * 2;\n        break;\n      case 'circle':\n        this.length = Math.PI * 2 * this.target.getAttribute('r');\n        break;\n      case 'line':\n        this.length = this.getLineLength(this.target.getAttribute('x1'),\n          this.target.getAttribute('y1'), this.target.getAttribute('x2'),\n          this.target.getAttribute('y2'));\n        break;\n      case 'polyline':\n      case 'polygon':\n        this.length = this.getPolyLength(this.tagName);\n        break;\n      case 'ellipse':\n        this.length = this.getEllipseLength();\n        break;\n      default:\n        this.length = this.target.getTotalLength();\n        break;\n    }\n    this.start.strokeDasharray = computedStyle.strokeDasharray === 'none'\n      ? '100% 100%' : computedStyle.strokeDasharray;\n    this.start.strokeDashoffset = parseFloat(computedStyle.strokeDashoffset);\n    this.start.strokeDasharray = this.setVars(this.start.strokeDasharray);\n    this.vars = this.setVars(this.vars);\n  },\n  setRatio(r, t) {\n    t.style.strokeDasharray = `${(this.vars.end - this.vars.start -\n      this.start.strokeDasharray.start) * r +\n      this.start.strokeDasharray.start}px, ${this.length}px`;\n    t.style.strokeDashoffset = -((this.vars.start + this.start.strokeDashoffset) * r\n      - this.start.strokeDashoffset);\n  },\n};\nexport default SvgDrawPlugin;\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugin/SvgDrawPlugin.jsx","import Tween from 'rc-tween-one';\nimport React from 'react';\nimport ReactDom from 'react-dom';\nimport SvgDrawPlugin from '../src/plugin/SvgDrawPlugin';\nTween.plugins.push(SvgDrawPlugin);\n\nconst dataStartArr = ['100%', '30 450', '50% 50%', '30% 400', '50 30%', 0];\nlet i = 0;\nclass Demo extends React.Component {\n  constructor() {\n    super(...arguments);\n    this.state = {\n      tweenData: '50 30%',\n    };\n  }\n\n  onClick() {\n    const tweenData = dataStartArr[i];\n    this.setState({\n      tweenData,\n    });\n    i++;\n    i = i >= dataStartArr.length ? 0 : i;\n  }\n\n  render() {\n    return (\n      <div>\n        <button onClick={this.onClick.bind(this)}>点击切换</button>\n        <p>当前参数：{this.state.tweenData}</p>\n        <svg width=\"100%\" height=\"600\" version=\"1.2\">\n          <Tween\n            animation={{ style: { SVGDraw: this.state.tweenData }, duration: 1000 }}\n            style={{ fill: '#fff000', strokeWidth: 5,\n              stroke: '#000fff', transform: 'translate(10px, 10px)',\n            }}\n            width=\"100\"\n            height=\"100\"\n            component=\"rect\"\n          />\n          <Tween\n            animation={{ style: { SVGDraw: this.state.tweenData }, duration: 1000 }}\n            style={{ fill: '#fff000', strokeWidth: 5, stroke: '#000fff' }}\n            component=\"polygon\"\n            points=\"120,10 200,10 230,110 150,110\"\n            attr=\"attr\"\n          />\n          <Tween\n            animation={{ style: { SVGDraw: this.state.tweenData }, duration: 1000 }}\n            style={{ fill: '#fff000', strokeWidth: 5, stroke: '#000fff' }}\n            component=\"circle\"\n            cx=\"300\" cy=\"55\" r=\"50\"\n            attr=\"attr\"\n          />\n          <Tween\n            animation={{ SVGDraw: this.state.tweenData, duration: 1000 }}\n            style={{ fill: '#fff000', strokeWidth: 5, stroke: '#000fff' }}\n            component=\"ellipse\"\n            cx=\"500\" cy=\"55\" rx=\"100\" ry=\"50\"\n          />\n          <Tween\n            animation={{ SVGDraw: this.state.tweenData, duration: 1000 }}\n            style={{ fill: '#fff000', strokeWidth: 5, stroke: '#000fff' }}\n            component=\"line\"\n            x1=\"0\" y1=\"150\" x2=\"500\" y2=\"150\"\n          />\n        </svg>\n      </div>);\n  }\n}\nReactDom.render(<Demo />, document.getElementById('__react-content'));\n\n\n\n// WEBPACK FOOTER //\n// ./examples/svgDrawShape.js"],"sourceRoot":""}